{% load static %}
<!DOCTYPE html>
<html>
<head>
     <!-- Meta information for the page -->
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Sandra Szczepaniak - Beauty Expert & Eyelash Trainer</title>
     <meta name="description" content="Sandra Szczepaniak offers professional eyelash styling, makeup services, and expert training for beauty professionals. Passionate about aesthetics and beauty education.">
     <meta name="keywords" content="Sandra Szczepaniak, beauty salon, eyelash stylist, lash extensions, lash lifting, lash lamination, makeup artist, beauty trainer, eyelash trainer, beauty education, aesthetic services, beauty expert, linguist, lash courses, beauty industry, makeup services, cosmetic training">
     <link rel="icon" type="image/x-icon" href="assets/favicon/favicon.ico">
     <link rel="stylesheet" href="{% static 'main/css/style.css' %}">
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
{% include "partials/header.html" %}

  <!-- Ikona czatu -->
<div id="chat-icon">
  <img class="chat_image" src="{% static 'main/img/chatbot.png' %}" alt="This is our link to chatbot"> 
</div>
 
<!-- Okno czatu -->
<div id="chat-window">
<div id="chat-messages"></div>
<div id="chat-input">
<input type="text" id="message" placeholder="Type a message...">
<button id="send-btn">Send</button>
</div>
</div>

</div>
<ul>
        <li></li>
</ul>

{% include "partials/footer.html" %}

<script src="{% static 'main/js/column.js' %}"></script>
<script src="{% static 'main/js/menu.js' %}"></script>
<script>
  const chatIcon = document.getElementById("chat-icon");
  const chatWindow = document.getElementById("chat-window");
  const sendBtn = document.getElementById("send-btn");
  const messageInput = document.getElementById("message");
  const chatMessages = document.getElementById("chat-messages");

  // Otwieranie/zamykanie czatu
  chatIcon.addEventListener("click", () => {
      chatWindow.style.display = (chatWindow.style.display === "none" || chatWindow.style.display === "") 
          ? "flex" : "none";
  });

  // Wysyłanie wiadomości
  sendBtn.addEventListener("click", sendMessage);
  messageInput.addEventListener("keypress", e => {
      if (e.key === "Enter") sendMessage();
  });

  function sendMessage() {
      const message = messageInput.value.trim();
      if (!message) return;

      // Dodaj wiadomość użytkownika
      addMessage("You", message, "user");
      messageInput.value = "";

      // Wysyłanie do backendu Django
      fetch(`/chatbot/?message=${encodeURIComponent(message)}`)
          .then(res => res.json())
          .then(data => {
              addMessage("Bot", data.reply, "bot");
          })
          .catch(() => {
              addMessage("Bot", "Error: could not connect to server", "bot");
          });
  }

  function addMessage(sender, text, type) {
      const msg = document.createElement("div");
      msg.classList.add("message", type);
      msg.innerHTML = `<strong>${sender}:</strong> ${text}`;
      chatMessages.appendChild(msg);
      chatMessages.scrollTop = chatMessages.scrollHeight;
  }
</script>
</body>
</html>